{"version":3,"file":"js/167.ebd7d350.js","mappings":"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","sources":["webpack://DOUJI.AI/./src/views/Update.vue","webpack://DOUJI.AI/./src/components/create/UpdateSuccessDialog.vue","webpack://DOUJI.AI/src/components/create/UpdateSuccessDialog.vue","webpack://DOUJI.AI/./src/components/create/UpdateSuccessDialog.vue?d68b","webpack://DOUJI.AI/./src/components/create/UpdateSuccessDialog.vue?b224","webpack://DOUJI.AI/src/views/Update.vue","webpack://DOUJI.AI/./src/views/Update.vue?1854","webpack://DOUJI.AI/./src/views/Update.vue?7d16"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"create-container\"},[(_vm.loadComplete)?[(_vm.step==1)?_c('create-step1',{attrs:{\"edit\":true,\"metadata\":_vm.metadata},on:{\"handleUpdate\":_vm.handleUpdate1,\"backClick\":_vm.backClick}}):_vm._e(),(_vm.step==2)?_c('create-step2',{attrs:{\"edit\":true,\"metadata\":_vm.metadata},on:{\"handleUpdate\":_vm.handleUpdate2,\"backClick\":_vm.backClick}}):_vm._e(),_c('UpdateSuccess',{ref:\"successDialog\",attrs:{\"tokenId\":_vm.tokenId,\"tx\":_vm.updateTxJson}})]:_vm._e()],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-dialog',{attrs:{\"custom-class\":\"mint-success-dialog\",\"visible\":_vm.show,\"width\":\"945px\"},on:{\"update:visible\":function($event){_vm.show=$event}}},[_c('img',{staticStyle:{\"width\":\"104px\",\"height\":\"104px\",\"margin-top\":\"85px\"},attrs:{\"src\":require(\"@/assets/images/create/mint-success.png\")}}),_c('div',{staticClass:\"mint-success-title\"},[_vm._v(\"Congratulations\")]),_c('div',{staticClass:\"mint-success-label text-color\"},[_vm._v(\"You have successfully initiated a vote to amend the NFT profile!\")]),_c('div',{staticClass:\"mint-success-info\"},[_c('div',{staticClass:\"info-label\"},[_c('div',{staticClass:\"info-label-item\"},[_vm._v(\"Transcantion ID\")])]),(_vm.tx.events)?_c('div',{staticClass:\"info-value\"},[_c('div',{staticClass:\"info-value-item\"},[_vm._v(_vm._s(_vm.tx.transactionHash))])]):_vm._e()]),_c('div',{staticClass:\"btn-container\"},[_c('el-button',{staticClass:\"common-btn2\",on:{\"click\":function($event){return _vm.toViewNft()}}},[_vm._v(\"View NFT\")])],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-dialog custom-class=\"mint-success-dialog\" :visible.sync=\"show\" width=\"945px\">\n    <img style=\"width: 104px;height: 104px;margin-top: 85px;\" src=\"@/assets/images/create/mint-success.png\" />\n    <div class=\"mint-success-title\">Congratulations</div>\n    <div class=\"mint-success-label text-color\">You have successfully initiated a vote to amend the NFT profile!</div>\n    <div class=\"mint-success-info\">\n      <div class=\"info-label\">\n        <div class=\"info-label-item\">Transcantion ID</div>\n      </div>\n      <div class=\"info-value\" v-if=\"tx.events\">\n        <div class=\"info-value-item\">{{ tx.transactionHash }}</div>\n      </div>\n    </div>\n    <div class=\"btn-container\">\n      <el-button @click=\"toViewNft()\" class=\"common-btn2\">View NFT</el-button>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nexport default {\n  name: 'update-success-dialog',\n  props: {\n    tx: {\n      type: Object,\n      default: () => {},\n    },\n    tokenId: {\n      type: String,\n      default: '',\n    },\n  },\n  data() {\n    return {\n      show: false,\n    }\n  },\n  methods: {\n    showDialog() {\n      this.show = true\n    },\n    toViewNft() {\n      this.$router.replace({\n        path: '/news-detail',\n        query: { tokenId: this.tokenId },\n      })\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n.mint-success-dialog {\n  background: #1a2027;\n  border: 1px solid #2c3638;\n  border-radius: 12px 6px 6px 6px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  .mint-success-title {\n    font-size: 30px;\n    font-family: Arial;\n    font-weight: bold;\n    color: #00f9e5;\n    margin-top: 35px;\n  }\n\n  .mint-success-label {\n    font-size: 18px;\n    font-family: Arial;\n    font-weight: bold;\n    margin-top: 23px;\n  }\n\n  .mint-success-info {\n    background: #212831;\n    border-radius: 15px;\n    padding: 48px 0 51px 0;\n    margin-top: 56px;\n    width: 848px;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n\n    .info-label {\n      text-align: left;\n\n      .info-label-item {\n        font-size: 14px;\n        font-family: Arial;\n        font-weight: 400;\n        color: #87a2b7;\n        margin-bottom: 22px;\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n      }\n    }\n\n    .info-value {\n      text-align: left;\n      margin-left: 41px;\n\n      .info-value-item {\n        font-size: 14px;\n        font-family: Arial;\n        font-weight: bold;\n        color: #ffffff;\n        margin-bottom: 22px;\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n      }\n    }\n  }\n\n  .btn-container {\n    margin: 49px 0 70px 0;\n  }\n\n  .el-dialog {\n    background: #1a2027;\n    border: 1px solid #2c3638;\n    border-radius: 12px 6px 6px 6px;\n  }\n\n  .el-dialog__body {\n    padding: 0 0;\n  }\n\n  .el-switch.is-checked .el-switch__core {\n    border-color: #00f9e5;\n    background-color: #00f9e5;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdateSuccessDialog.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdateSuccessDialog.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./UpdateSuccessDialog.vue?vue&type=template&id=40c09188\"\nimport script from \"./UpdateSuccessDialog.vue?vue&type=script&lang=js\"\nexport * from \"./UpdateSuccessDialog.vue?vue&type=script&lang=js\"\nimport style0 from \"./UpdateSuccessDialog.vue?vue&type=style&index=0&id=40c09188&prod&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"create-container\">\n    <template v-if=\"loadComplete\">\n      <create-step1 v-if=\"step==1\" :edit=\"true\" :metadata=\"metadata\" @handleUpdate=\"handleUpdate1\" @backClick=\"backClick\"></create-step1>\n      <create-step2 v-if=\"step==2\" :edit=\"true\" :metadata=\"metadata\" @handleUpdate=\"handleUpdate2\" @backClick=\"backClick\"></create-step2>\n      <UpdateSuccess :tokenId=\"tokenId\" ref=\"successDialog\" :tx=\"updateTxJson\" />\n    </template>\n  </div>\n</template>\n\n<script>\nimport CreateStep1 from '@/components/create/CreateStep1'\nimport CreateStep2 from '@/components/create/CreateStep2'\nimport UpdateSuccess from '@/components/create/UpdateSuccessDialog'\nimport { weiToMbd } from '@/utils/common'\nimport { loadFromUrl, unlockContent, uploadJson } from '@/utils/http'\nimport { startSetTokenPrice, startSetTokenURI } from '@/utils/web3/nft'\nimport { getTokenOwner, tokenURI, tokensData } from '@/utils/web3/open'\nexport default {\n  name: 'update-view',\n  components: {\n    CreateStep1,\n    CreateStep2,\n    UpdateSuccess,\n  },\n  data() {\n    return {\n      loadComplete: false,\n      metadata: {},\n      ipfsData: {},\n      step: 0,\n      tokenId: undefined,\n      tokenSupplyInfo: {},\n      tokenMetaUrl: undefined,\n      tokenOwner: undefined,\n      updateTxJson: {},\n    }\n  },\n  mounted() {\n    this.tokenId = this.$route.query.tokenId\n    this.step = this.$route.query.step\n    var loadingInstance = this.$loading({\n      background: 'rgba(0, 0, 0, 0.8)',\n    })\n    setTimeout(() => {\n      Promise.all([this.getOwner(), this.loadSupplyInfo(), this.loadMetadata()])\n        .then(() => {\n          if (this.tokenSupplyInfo.isVoting) {\n            this.$toast.warning(this.$t('create.nft_voting'))\n            this.$router.back()\n            return\n          }\n          if (\n            this.tokenOwner.toLowerCase() !=\n            this.$store.state.user.account.toLowerCase()\n          ) {\n            this.$toast.warning(this.$t('create.no_permission_update'))\n            this.$router.back()\n            return\n          }\n          this.metadata.maxSupply = this.tokenSupplyInfo.maxSupply\n          this.metadata.initialQuantity = this.tokenSupplyInfo.currentSupply\n          this.metadata.availableSupply = this.tokenSupplyInfo.availableSupply\n          this.metadata.initialPrice = weiToMbd(\n            this.tokenSupplyInfo.price.price\n          )\n          this.loadComplete = true\n        })\n        .catch((e) => {\n          console.log(e)\n        })\n        .finally(() => {\n          loadingInstance.close()\n        })\n    }, 4000)\n  },\n  methods: {\n    /** 页面后退 */\n    backClick() {\n      this.$router.back()\n    },\n    /** 获取token拥有者 */\n    getOwner() {\n      return new Promise((resolve, reject) => {\n        if (!this.tokenId) {\n          reject()\n        }\n        getTokenOwner(this.tokenId)\n          .then((owner) => {\n            this.tokenOwner = owner\n            resolve()\n          })\n          .catch(() => {\n            reject()\n          })\n      })\n    },\n    /** 加载数据 */\n    loadSupplyInfo() {\n      return new Promise((resolve, reject) => {\n        if (!this.tokenId) {\n          reject()\n        }\n        tokensData(this.tokenId)\n          .then((res) => {\n            this.tokenSupplyInfo = res\n            resolve()\n          })\n          .catch(() => {\n            reject()\n          })\n      })\n    },\n    /** 加载元数据 */\n    loadMetadata() {\n      return new Promise((resolve, reject) => {\n        if (!this.tokenId) {\n          reject()\n        }\n        tokenURI(this.tokenId)\n          .then((uri) => {\n            this.tokenMetaUrl = uri\n            loadFromUrl(this.tokenMetaUrl).then((r) => {\n              if (r.status !== 200) {\n                reject(r.statusText)\n              }\n              this.metadata = r.data\n              if (this.metadata.contentUrl && this.step == 2) {\n                return Promise.all([\n                  this.loadOpenContent(this.metadata.contentUrl),\n                  this.loadProtectedContent(this.metadata.protected),\n                ])\n                  .then(([openContent, protectedContent]) => {\n                    this.metadata.openContent = openContent\n                    this.metadata.protectedContent = protectedContent\n                    resolve()\n                  })\n                  .catch((e) => {\n                    reject(e)\n                  })\n              }\n              resolve()\n            })\n          })\n          .catch(() => {\n            reject()\n          })\n      })\n    },\n    /** 加载公开数据 */\n    loadOpenContent(url) {\n      return new Promise((resolve, reject) => {\n        loadFromUrl(url).then((res) => {\n          if (res.status !== 200) {\n            reject(res.statusText)\n          }\n          resolve(res.data)\n        })\n      })\n    },\n    /** 加载私有数据 */\n    loadProtectedContent(data) {\n      return new Promise((resolve, reject) => {\n        unlockContent(data, this.tokenId).then((res) => {\n          if (res.code != 1) {\n            reject(res.message)\n          }\n          const ipfsUrl = res.data.url\n          loadFromUrl(ipfsUrl).then((r) => {\n            if (r.status !== 200) {\n              reject(r.statusText)\n            }\n            resolve(r.data)\n          })\n        })\n      })\n    },\n    /** 更新1 */\n    handleUpdate1(form) {\n      const initialPriceUpdate = form.initialPrice\n      const availableSupplyUpdate = form.availableSupply\n      var loadingInstance = this.$loading({\n        background: 'rgba(0, 0, 0, 0.8)',\n      })\n      startSetTokenPrice(\n        this.tokenId,\n        initialPriceUpdate,\n        availableSupplyUpdate\n      )\n        .then((tx) => {\n          console.log(tx)\n          this.updateTxJson = tx\n          this.$refs['successDialog'].showDialog()\n        })\n        .catch((e) => {\n          this.$toast.warning(e)\n        })\n        .finally(() => {\n          loadingInstance.close()\n        })\n    },\n    /** 更新2 */\n    handleUpdate2(form) {\n      const metaJson = this.makeURI(form)\n      console.log(metaJson)\n      var loadingInstance = this.$loading({\n        background: 'rgba(0, 0, 0, 0.8)',\n      })\n      uploadJson(metaJson)\n        .then((r) => {\n          if (r.code == 1) {\n            const metaUrl = r.data.url\n            startSetTokenURI(this.tokenId, metaUrl)\n              .then((tx) => {\n                console.log(tx)\n                this.updateTxJson = tx\n                this.$refs['successDialog'].showDialog()\n              })\n              .catch((e) => {\n                this.$toast.warning(e)\n              })\n              .finally(() => {\n                loadingInstance.close()\n              })\n          } else {\n            this.$toast.warning(r.message)\n          }\n        })\n        .catch((e) => {\n          this.$toast.warning(e)\n        })\n    },\n    /** 生成URI */\n    makeURI(form) {\n      const metaJson = {\n        title: form.title,\n        name: form.title,\n        image: form.image,\n        maxSupply: form.maxSupply,\n        description: form.description,\n        contentType: form.contentType,\n        category: form.category,\n        keyword: form.keyword,\n        attributes: [\n          {\n            trait_type: 'title',\n            value: form.title,\n          },\n          {\n            trait_type: 'category',\n            value: form.category,\n          },\n          {\n            trait_type: 'contentType',\n            value: form.contentType,\n          },\n          {\n            trait_type: 'contentUrl',\n            value: form.contentUrl,\n          },\n          {\n            display_type: 'date',\n            trait_type: 'Birthday',\n            value: form.Birthday,\n          },\n          {\n            display_type: 'date',\n            trait_type: 'UpdateDay',\n            value: new Date().getTime(),\n          },\n        ],\n        contentUrl: form.contentUrl,\n        protected: form.protected,\n        UpdateDay: new Date().getTime(),\n        Birthday: form.Birthday,\n      }\n      if (form.language) {\n        metaJson.language = form.language\n      }\n      if (form.prompt) {\n        metaJson.prompt = form.prompt\n      }\n      return metaJson\n      // return new Promise((resolve, reject) => {\n      //   uploadJson(metaJson)\n      //     .then((r) => {\n      //       if (r.code == 1) {\n      //         resolve(r.data.url)\n      //       } else {\n      //         reject(r.message)\n      //       }\n      //     })\n      //     .catch((e) => {\n      //       console.log(e)\n      //       reject(e.message ? e.message : e)\n      //     })\n      // })\n    },\n  },\n}\n</script>\n<style lang=\"scss\" scoped>\n.create-container {\n  display: flex;\n  flex-direction: column;\n\n  .step-container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    margin-top: 62px;\n\n    .step {\n      text-align: left;\n\n      .step-title {\n        font-size: 19px;\n        font-family: Source Han Sans CN;\n        font-weight: bold;\n        color: #747c7c;\n      }\n\n      .step-sub {\n        font-size: 12px;\n        font-family: Source Han Sans CN;\n        font-weight: 400;\n        color: #747c7c;\n        margin-top: 10px;\n      }\n    }\n\n    .step-light {\n      .step-title {\n        font-size: 19px;\n        font-family: Source Han Sans CN;\n        font-weight: bold;\n        color: #4cc9ce;\n        background: linear-gradient(-16deg, #4195f6 0%, #00f9e5 100%);\n        -webkit-background-clip: text;\n        -webkit-text-fill-color: transparent;\n      }\n\n      .step-sub {\n        font-size: 12px;\n        font-family: Source Han Sans CN;\n        font-weight: 400;\n        color: #50ced5;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Update.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Update.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Update.vue?vue&type=template&id=401da035&scoped=true\"\nimport script from \"./Update.vue?vue&type=script&lang=js\"\nexport * from \"./Update.vue?vue&type=script&lang=js\"\nimport style0 from \"./Update.vue?vue&type=style&index=0&id=401da035&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"401da035\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","loadComplete","step","attrs","metadata","on","handleUpdate1","backClick","_e","handleUpdate2","ref","tokenId","updateTxJson","staticRenderFns","show","$event","staticStyle","require","_v","tx","events","_s","transactionHash","toViewNft","name","props","type","Object","default","String","data","methods","showDialog","$router","replace","path","query","component","components","CreateStep1","CreateStep2","UpdateSuccess","ipfsData","undefined","tokenSupplyInfo","tokenMetaUrl","tokenOwner","mounted","$route","loadingInstance","$loading","background","setTimeout","Promise","all","getOwner","loadSupplyInfo","loadMetadata","then","isVoting","$toast","warning","$t","back","toLowerCase","$store","state","user","account","maxSupply","initialQuantity","currentSupply","availableSupply","initialPrice","weiToMbd","price","catch","e","console","log","finally","close","resolve","reject","getTokenOwner","owner","tokensData","res","tokenURI","uri","loadFromUrl","r","status","statusText","contentUrl","loadOpenContent","loadProtectedContent","protected","openContent","protectedContent","url","unlockContent","code","message","ipfsUrl","form","initialPriceUpdate","availableSupplyUpdate","startSetTokenPrice","$refs","metaJson","makeURI","uploadJson","metaUrl","startSetTokenURI","title","image","description","contentType","category","keyword","attributes","trait_type","value","display_type","Birthday","Date","getTime","UpdateDay","language","prompt"],"sourceRoot":""}